<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
    <entry key="check-author-existence">
        select count(*) = :expectedAmount as passed_authors
        from authors
        where author_id in (:expectedAuthors)
    </entry>
    <entry key="get-book-information">
        select b.isbn, b.title, a.author_id
        from
            books b left join
            book_authors ba on b.isbn
        where
            b.isbn = :book_isbn
        for update
    </entry>
    <entry key="save-book-information">
        insert into books (isbn,title)
        values
            (:book_isbn,:book_title)
        on conflict do
        update
            set title = :book_title
            where isbn = :book_isbn
    </entry>
    <entry key="save-author-information">
        insert into authors (author_id,author_name)
        values
            (:author_id,:author_name)
        on conflict do
        update set author_name = :author_name
            where author_id = :author_id
    </entry>
    <entry key="relate-book-with-author">
        insert into book_authors (book_isbn,author_id)
        values
            (:book_isbn,:author_id)
        on conflict do nothing
    </entry>
    <entry key="derelate-book-with-not-given-authors">
        delete from book_authors
        where book_isbn = :book_isbn and
            author_id not in (:author_id)
    </entry>
    <entry key="delete-book">
        delete from books where isbn = :book_isbn
    </entry>
    <entry key="delete-book-relationship-with-authors">
        delete from book_authors where book_isbn = :book_isbn
    </entry>
</properties>